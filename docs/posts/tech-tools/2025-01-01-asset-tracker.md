
---"
categories: "
  - "技术工具"
date: "2025-01-01'"
description: "1、需求目的我在做一个基于微信小程序的收支记录、家庭资产负债的财务管理工具，该小程序包括几个功能注册登陆：微信免登录注册流程记账模块账本功能新增账本，邀请他人一起加入账本，一个账本可以有多个成员。账本存在默认账本分类，账本分类可以编辑记账功能：可以手动"
  添加/编辑/删除收入、支出记录允许上传支..."
/assets/images/posts/tech-tools/2025-01-01-assettracker/image: /assets/images/posts/tech-tools/2025-01-01-assettracker/image_47.jpeg"
original_title: "Asset Tracker""
---published: true"
tags: "
  - "技术"
title: "Asset Tracker"
yuque_url: ''"
---"
## 1、需求目的

我在做一个基于微信小程序的收支记录、家庭资产负债的财务管理工具，该小程序包括几个功能

  * 注册登陆：微信免登录注册流程
  * 记账模块

    * 账本功能

      * 新增账本，邀请他人一起加入账本，一个账本可以有多个成员。
      * 账本存在默认账本分类，账本分类可以编辑

    * 记账功能：

      * 可以手动 添加/编辑/删除收入、支出记录
      * 允许上传支付宝/微信支付账单，实现 ocr 识别添加收入、支出记录

    * 账本统计功能：

      * 按照年月、年维度统计账单收入、支出、结余、储蓄率情况
      * 能够查看分类报表的年月、年维度数据情况

  * 财务功能

    * 家庭资产负债

      * 录入家庭成员
      * 录入家庭成员的资产、负债数据
      * 生成相关数据统计

    * 投资理财

      * 录入家庭成员
      * 录入家庭成员的投资理财数据
      * 生成相关数据统计

    * 家庭保单管理

      * 录入家庭成员
      * 录入家庭成员的保单管理
      * 生成相关数据统计

  * 我的

    * 账号管理
    * 家庭成员管理

      * 新增家庭成员

    * 账单导入/导出

## 2、需求实现方案

  1. 前端：微信小程序
  2. 后端：微信云开发
  3. 环境：dev-4glbr3q9bbe8ef48
  4. AppID：wx54bd7f9370888355
  5. 小程序名称：Asset Tracker

## 3、需求背景

## 3.1 业务背景

  1. 我日常有记账的需求，会每天记录自己的收支情况，同时在月底的时候更新自己的家庭资产负债情况。
  2. 除了更新我自己的数据以外，我还会更新家庭成员的收支情况和整体的资产负债情况。

## 3.2 目前遇到的问题

  1. 收支情况的更新经常不及时，依赖于手动录入到软件中。
  2. 目前没办法查看家庭成员的收支数据情况，期望能够针对家庭成员的收支情况统一管理和查看。
  3. 每个月更新资产负债情况时，目前依赖于本地excel表格更新，导致没办法形成每个月/每年的汇总数据以及不同维度的汇总数据分析，检阅家庭资产负债情况。

## 4、需求方案概述

## 4.1 产品信息架构

  

## 4.2 注册登陆功能

注册登陆

## 4.3 首页/账单

账单功能模块包括收支管理、邀请他人加入账本、收支报表通知。

### 4.3.1 账单功能首页

顶部卡片是本月收支结余数据，顶部增加筛选功能，支持按照年月、年的收支结余数据统计；同时还可以看到某一类账单分类饼图统计，点击后可以查看数据明细。

下面是每日收支结余数据，按照日期倒序。

### 4.3.2 共享账本

邀请他人加入账本时，他人需要登陆注册后才允许添加。

创建者邀请他人时，需要填写邀请人的关系。

创建者：拥有该账本的所有权限，可以对账本的分类、预算进行增加、修改、删除等操作，可以邀请/删除其他人加入账本。

普通成员：仅可对账本分类、预算、记账等进行操作。

注意：所有成员仅可以修改、删除自己记录的账单，其他成员的账单可以查看，但不可以修改或者删除。

### 4.3.3 账本分类管理

账本默认是支出、收入分类，支出收入分类下可以设置一级分类、二级分类，其中默认数据是默认分类，可以手动调整。

支出默认分类包括，购物、餐饮、房租、房贷、出行、休闲娱乐、日常、其他

收入默认分类包括，工资、劳动报酬的等等。

### 4.3.4 账本导入

支持 ocr 导入账本，包括识别微信账单和支付宝账单。

账单也可以 excel/csv 格式导入，导入模版你可以帮我设计一个。

## 4.4 财务

账务模块包括家庭资产负债功能、投资理财管理功能、保单管理功能。

### 4.4.1 财务功能首页

顶部卡片是最新一次更新的家庭资产负债数据，顶部增加筛选功能，支持按照年月、年的家庭资产负债数据统计。

支持手动录入家庭资产负债数据，资产包括流动性资产、投资性资产、自用性资产，负债包括流动性负债、投资性负债、自用性负债。

### 4.4.2 投资理财管理

  

### 4.4.3 保单管理

  

## 4.5 设置

账号管理设置、账本

### 4.5.1 共享账本

  

  

## 5.前端布局设计

## 5.1 页面目录结构
    
    
    首页
       │
       ├── 月度收支卡片
       │   ├── 本月收入
       │   ├── 本月支出
       │   ├── 结余状态
       │   └── 预算进度
       │
       │
       ├── 账单列表
       │   ├── 日期分组
       │   ├── 收支类型
       │   ├── 分类图标
       │   ├── 备注信息
       │   └── 金额显示
       │
       └── 悬浮记账按钮
           ├── 支出记录
           ├── 收入记录

  

## 5.2 记账页面

### 5.2.1 添加记账记录 
    
    
    ┌──────── 记账明细 ─────────┐
    │   [支出 | 收入]           │ ← 顶部支持切换
    │                         │
    │   [餐饮*] [交通] [购物]   │← 主分类区域（固定布局，5列）
    │   [娱乐] [居住] [通讯]    │← *选中状态，高亮显示
    │   [医疗] [学习] [其他]    │← 展示图标+名称
    │                          │
    │   ┌───────────────────┐  │
    │   │ [🍚三餐] [🥘食材]  │  │← 子分类区域（固定布局，5列）
    │   │ [🍎水果] [🍪零食]  │  │← 灰色卡片容器
    │   │ [🥤饮料]          │  │ ← 当选中餐饮时，显示其子分类
    │   └───────────────────┘  │
    │                          │
    │                          │
    │   ┌───────────────────┐  │
    │   │ [点击输入备注]  ¥ 0.00 ││← 详情和金额区域（合并为一个区域）
    │   │ [2024-01-06]     │   ││← 点击日期，弹出日期选择器
    │   └───────────────────┘  │             │
    │   [1]   [2]   [3]   [×]  │
    │   [4]   [5]   [6]   [+]  │
    │   [7]   [8]   [9]   [-]  │
    │   [0]   [.]   [  保存  ]  │← 保存占两格
    │                          │
    └──────────────────────────┘

### 5.2.2 添加记账页面的日期选择 
    
    
    ┌─────── 日期选择 ───────┐
    │   <  2024年2月  >      │ ← 顶部年月标题两侧有左右箭头，支持切换月份
    ├─ 一 二 三 四 五 六 日   ─┤ ← 中间是日历网格，突出显示当前选中日期
    │  1  2  3  4  5  6  7  │
    │  8  9  10 11 12 13 14 │
    │ 15 16 17 18 19 20 21  │
    │ 22 23 24 25 26 27 28  │
    │ 29                    │
    ├────── 快捷选择 ────────┤
    │  今天  昨天   前天     │ ← 快捷键
    ├────── 操作按钮 ────────┤
    │        取消   确定     │
    └────────────────────────┘

  

## 5.3 我的页面布局结构
    
    
    ┌──────── 用户信息 ─────────┐
    │   ○    昵称               │ ← 用户头像和昵称，点击进入账号管理             │
    └──────────────────────────┘
    
    ┌──────── 我的账本 ─────────┐
    │ 📚 我的账本           >  │ ← 点击进入账本管理页面
    └──────────────────────────┘
    
    ┌──────── 数据管理 ─────────┐
    │ 📥 账单导入           >  │ ← Excel导入
    │ 📤 账单导出           >  │ ← Excel导出
    │ 💾 数据备份           >  │ ← 云端备份/恢复
    └──────────────────────────┘
    
    ┌──────── 其他功能 ─────────┐
    │ ℹ️ 关于我们           >  │ ← 版本、作者等信息
    │ 💬 意见反馈           >  │ ← 意见反馈入口
    │ 🔄 检查更新    v1.0.0    │ ← 版本更新检查
    └──────────────────────────┘
    
    ┌──────────────────────────┐
    │        退出登录          │ ← 红色按钮，清除登录状态
    └──────────────────────────┘

### 5.3.1 账号管理
    
    
    ┌──────────────────────────┐
    │     账号管理             │ ← 导航栏标题
    └──────────────────────────┘
    
    ┌──────────────────────────┐
    │    ○                     │ 
    │  更换头像                │ ← 圆形头像居中显示，下方有更换提示
    └──────────────────────────┘
    
    ┌──────── 基本信息 ────────┐
    │ 昵称                     │
    │ ○ 张三          >       │ ← 左侧显示头像，右侧昵称和箭头
    │                         │
    │ 手机号                   │
    │ 138****8888    更换 >   │ ← 手机号脱敏显示，右侧更换按钮
    └──────────────────────────┘
    
    ┌──────── 账号安全 ────────┐
    │ 登录密码         修改 >  │ ← 右侧显示修改按钮
    │                         │
    │ 微信账号         绑定 >  │ ← 未绑定显示"绑定"，已绑定显示微信昵称
    │                         │
    │ 实名认证         未认证 >│ ← 显示认证状态
    └──────────────────────────┘
    
    ┌──────────────────────────┐
    │        退出登录          │ ← 红色按钮，固定在底部
    └──────────────────────────┘

### 5.3.2 账本管理
    
    
    ┌──────── 我的账本 ─────────┐
    │                          │ ← 导航栏标题
    └──────────────────────────┘
    
    ┌──────── 我的账本 ────────┐
    │ 📚 生活账本   [常用]  │ ← 列表项带标记
    │    2024-01 创建          │ ← 显示创建时间
    │                          │
    │ 📚 旅行账本              │ ← 其他账本
    │    2024-02 创建          │
    │                          │
    │ 📚 家庭账本              │
    │    2024-03 创建          │
    └──────────────────────────┘
    
    ┌──────────────────────────┐
    │       ➕ 新建账本        │ ← 固定在底部的新建按钮
    └──────────────────────────┘
    
    
    主要功能和交互：
    1. 账本列表：
       - 显示所有账本
       - 每个账本显示名称、创建时间
       - 常用的账本有特殊标记
       - 左滑可以显示删除按钮（非当前账本）
       - 点击可以查看账本详情
    
    2. 新建账本：
       - 固定在底部的新建按钮
       - 点击弹出新建账本表单
       - 可以设置账本名称和描述
    

## 5.4 首页展示
    
    
    ┌─ 账本页面 ──────────────────────────────┐
    │                                         │
    │ ┌─ 顶部卡片(蓝色渐变背景) ─────────────┐ │
    │ │ 默认账本          2025-01 ▼          │ │ <- 1. 账本名称和月份选择器
    │ │                                      │ │
    │ │ 结余                                 │ │
    │ │ ¥1234.56                            │ │ <- 2. 月度汇总数据
    │ │                                      │ │
    │ │ 支出 ¥347.00    收入 ¥1581.56       │ │
    │ └──────────────────────────────────────┘ │
    │                                         │
    │ ┌─ 统计图表 ────────────────────────────┐ │
    │ │ 最近7天支出                          │ │ <- 3. 图表标题
    │ │ 总支出：¥1234.56                     │ │ <- 4. 灰色小字体
    │ │                                      │ │
    │ │    柱状图显示区域                    │ │ <- 5. 图表配置：
    │ │    ███  ███  ███  ███  ███  ███  ███ │ │    - 左边距 5%
    │ │    1/1  1/2  1/3  1/4  1/5  1/6  1/7│ │    - 右边距 5%
    │ └──────────────────────────────────────┘ │    - 上边距 8%
    │                                         │    - 下边距 8%
    │ ┌─ 交易记录 ────────────────────────────┐ │
    │ │ 交易记录                             │ │ <- 6. 列表标题
    │ │                                      │ │
    │ │ 2025-01-09          支：¥347        │ │ <- 7. 日期行：
    │ │ ├─ 早餐             -¥15            │ │    - 左边显示日期
    │ │ └─ 午餐             -¥32            │ │    - 右边显示汇总
    │ │                                      │ │      * 只有支出：支：¥xx
    │ │ 2025-01-08      结余：¥138          │ │      * 只有收入：收：¥xx
    │ │ ├─ 工资           +¥500             │ │      * 有收有支：结余：¥xx
    │ │ ├─ 购物           -¥300             │ │
    │ │ └─ 晚餐            -¥62             │ │
    │ │                                      │ │
    │ │ 2025-01-07          收：¥500        │ │
    │ │ └─ 工资           +¥500             │ │
    │ └──────────────────────────────────────┘ │
    │                                         │
    │                 [+]                     │ <- 8. 添加按钮(固定位置)
    └─────────────────────────────────────────┘
    
    开发要点：
    1. 数据加载和刷新：
       - onLoad: 初始化数据
       - onShow: 已初始化则刷新数据
       - 下拉刷新支持
    
    2. 顶部卡片：
       - 月份选择器（年-月）
       - 月度收支统计（收入、支出、结余）
    
    3. 统计图表：
       - 使用 ec-canvas 组件
       - 7天支出数据柱状图
       - 优化图表边距和样式
       - 大数字显示优化(>1000显示为k)
       - 总支出灰色小字体(24rpx)
    
    4. 交易记录：
       - 按日期分组展示
       - 日期行显示汇总信息
       - 支出红色，收入绿色
       - 点击记录跳转详情
    
    5. 数据库查询优化：
       - 使用范围查询替代正则
       - 月度数据：gte(startDate).and(lte(endDate))
       - 7天数据：command.in(dates)
    
    6. 样式规范：
       - 卡片样式：白底圆角阴影
       - 间距：30rpx 卡片间距
       - 内边距：40rpx 30rpx
       - 文字：主文字32rpx，次要24rpx

## 5.5 财务页面

### 5.5.1 资产负债

![](/assets//assets/images/posts/tech-tools/2025-01-01-assettracker/image_47.jpeg)

  

    
    
    ┌─────────────────────────────────┐
    │        家庭资产记账            │ <- 导航栏
    ├─────────────────────────────────┤
    │ 全部 │ 我 │ pp                │ <- 标签切换栏
    │ ▔▔▔▔                          │    蓝色下划线指示器
    ├─────────────────────────────────┤
    │ ┌─────────────────────────┐    │
    │ │总资产 (元) 👁          │    │ <- 20rpx内边距
    │ │1,589,013.60            │    │    轻微阴影
    │ │                        │    │
    │ │净资产  1,043,145.60    │    │
    │ │负债率  34.35%          │    │
    │ │                        │    │
    │ │2025.01.01更新          │    │
    │ └─────────────────────────┘    │
    │                               │
    │ 相比2024年10月1日             │
    │ ┌─────────────────┐          │
    │ │总资产  总负债    │          │ <- 图表区域
    │ │↑1,808  没有变化  │          │    柱状图显示
    │ │                 │          │
    │ │[图表显示区域]    │          │
    │ └─────────────────┘          │
    │                               │
    │ ┌─────────────────┐          │
    │ │投资记账         │          │ <- 功能卡片
    │ │+15.05% 年化     │          │    带图标和数据
    │ │2025.01.01更新   │          │
    │ └─────────────────┘          │
    │                               │
    │ ┌─────────────────┐          │
    │ │年度现金流       │          │
    │ │预算超支         │          │
    │ │预计年度超支     │          │
    │ │12,000元         │          │
    │ └─────────────────┘          │
    │                               │
    │ 家庭保单管理                  │
    │ [意外][医疗][重疾][寿险] >    │ <- 横向滚动菜单
    │                               │
        [安全区域]
    ┌─────────────────────────────────┐
    │     [      更新资产     ]      │ <- 固定底部按钮
    └─────────────────────────────────┘
    └─────────────────────────────────┘

